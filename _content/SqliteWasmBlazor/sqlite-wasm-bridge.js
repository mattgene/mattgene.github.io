var a=null;(async()=>{try{let o=document.querySelector("base")?.getAttribute("href")||"/";a=new Worker(`${o}_content/SqliteWasmBlazor/sqlite-wasm-worker.js`,{type:"module"}),a.postMessage({type:"init",baseHref:o}),a.onmessage=async r=>{if(r.data.type==="ready"){console.log("[Worker Bridge] Worker ready");try{(await globalThis.getDotnetRuntime(0).getAssemblyExports("SqliteWasmBlazor.dll")).SqliteWasmBlazor.SqliteWasmWorkerBridge.OnWorkerReady()}catch(e){console.error("[Worker Bridge] Failed to call OnWorkerReady:",e)}return}if(r.data.type==="error"){console.error("[Worker Bridge] Worker error:",r.data.error);try{(await globalThis.getDotnetRuntime(0).getAssemblyExports("SqliteWasmBlazor.dll")).SqliteWasmBlazor.SqliteWasmWorkerBridge.OnWorkerError(r.data.error||"Unknown worker error")}catch(e){console.error("[Worker Bridge] Failed to call OnWorkerError:",e)}return}if(r.data.id!==void 0)try{let e=await globalThis.getDotnetRuntime(0).getAssemblyExports("SqliteWasmBlazor.dll");if(r.data.binary&&r.data.data instanceof Uint8Array)e.SqliteWasmBlazor.SqliteWasmWorkerBridge.OnWorkerResponseBinary(r.data.id,r.data.data);else{let t=JSON.stringify(r.data);e.SqliteWasmBlazor.SqliteWasmWorkerBridge.OnWorkerResponse(t)}}catch(e){console.error("[Worker Bridge] Failed to call C# callback:",e)}},a.onerror=r=>{console.error("[Worker Bridge] Worker error event:",r)}}catch(o){console.error("[Worker Bridge] Failed to create worker:",o)}})();function s(o){if(!a)throw new Error("Worker not initialized");let r=JSON.parse(o);a.postMessage(r)}var l={setLogLevel(o){if(!a){console.warn("[Worker Bridge] Worker not initialized, cannot set log level");return}a.postMessage({type:"setLogLevel",level:o})}};globalThis.sqliteWasmWorker={sendToWorker:s};globalThis.__sqliteWasmLogger=l;export{l as logger,s as sendToWorker};
